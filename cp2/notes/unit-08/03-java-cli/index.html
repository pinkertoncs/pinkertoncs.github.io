<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>PinkertonCS</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link rel="shortcut icon" href="/favicon.ico" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/intro/">Intro to Computer Science</a></li>
      
      <li><a href="/cp1/">Programming 1</a></li>
      
      <li><a href="/cp2/">Programming 2</a></li>
      
      <li><a href="/apcs/">AP Computer Science</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">Lesson 03 - Java CLI</span></h1>


</div>

<main>


<h2 id="command-line-interface-cli">Command-line Interface (CLI)</h2>

<h2 id="object-oriented-cli">Object-oriented CLI</h2>

<ul>
<li>Our Java OO CLI subsystem will contain the following

<ul>
<li>The <strong>Command interface</strong>, which specifies the method that all Commands must implement <code>void run(String[] params)</code></li>
<li>Each <strong>Command object</strong> is an instance of a unique class, which implements the <em>Command interface</em></li>
<li>The <strong>CommandSet</strong> contains a <em>Hashmap</em> of <em>Command</em> objects</li>
<li>The <strong>CLI</strong> class has a <em>CommandSet</em></li>
</ul></li>
</ul>

<p><img src="/images/cp2/unit-08/cli.png" alt="" /></p>

<h2 id="java-code">Java Code</h2>

<h3 id="the-command-interface">The Command Interface</h3>

<ul>
<li>Specifies the <em>contract</em> that all &ldquo;Commands&rdquo; must adhere to</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a2f;font-weight:bold">public</span> <span style="color:#a2f;font-weight:bold">interface</span> <span style="color:#00f">Command</span> <span style="color:#666">{</span>

    <span style="color:#0b0;font-weight:bold">void</span> <span style="color:#00a000">run</span><span style="color:#666">(</span>String<span style="color:#666">[]</span> params<span style="color:#666">);</span>

<span style="color:#666">}</span></code></pre></div>
<h3 id="the-commandset-class">The CommandSet class</h3>

<ul>
<li>The <em>Command</em> classes are defined inside the <em>CommandSet</em></li>
<li>The <em>Command</em> objects are instantiated and added to the <em>HashMap</em> in the constructor</li>
<li>The constructor is places before the <em>Command</em> definitions for our convenience, so we are able to see the commands in the <em>HashMap</em> neat the top of the file</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a2f;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">java.util.HashMap</span><span style="color:#666">;</span>

<span style="color:#a2f;font-weight:bold">public</span> <span style="color:#a2f;font-weight:bold">class</span> <span style="color:#00f">CommandSet</span> <span style="color:#666">{</span>

	HashMap<span style="color:#666">&lt;</span>String<span style="color:#666">,</span> Command<span style="color:#666">&gt;</span> commands<span style="color:#666">;</span>

    <span style="color:#080;font-style:italic">/************* CONSTRUCTOR ****************/</span>

	<span style="color:#a2f;font-weight:bold">public</span> <span style="color:#00a000">CommandSet</span><span style="color:#666">()</span> <span style="color:#666">{</span>

		commands<span style="color:#666">=</span><span style="color:#a2f;font-weight:bold">new</span> HashMap<span style="color:#666">&lt;</span>String<span style="color:#666">,</span> Command<span style="color:#666">&gt;();</span>

		<span style="color:#080;font-style:italic">// add commands here
</span><span style="color:#080;font-style:italic"></span>		commands<span style="color:#666">.</span><span style="color:#b44">put</span><span style="color:#666">(</span><span style="color:#b44">&#34;echo&#34;</span><span style="color:#666">,</span> <span style="color:#a2f;font-weight:bold">new</span> echoCmd<span style="color:#666">());</span>
	<span style="color:#666">}</span>

    <span style="color:#080;font-style:italic">/************* COMMAND DEFINITIONS ****************/</span>

	<span style="color:#080;font-style:italic">/**
</span><span style="color:#080;font-style:italic">	 * echo command - prints the parameters
</span><span style="color:#080;font-style:italic">	 */</span>
	<span style="color:#a2f;font-weight:bold">class</span> <span style="color:#00f">echoCmd</span> <span style="color:#a2f;font-weight:bold">implements</span> Command <span style="color:#666">{</span>
		<span style="color:#a2f;font-weight:bold">public</span> <span style="color:#0b0;font-weight:bold">void</span> <span style="color:#00a000">run</span><span style="color:#666">(</span>String<span style="color:#666">[]</span> params<span style="color:#666">)</span> <span style="color:#666">{</span>

			<span style="color:#a2f;font-weight:bold">for</span><span style="color:#666">(</span> <span style="color:#0b0;font-weight:bold">int</span> i<span style="color:#666">=</span>0<span style="color:#666">;</span> i<span style="color:#666">&lt;</span>params<span style="color:#666">.</span><span style="color:#b44">length</span><span style="color:#666">;</span> i<span style="color:#666">++)</span>
				System<span style="color:#666">.</span><span style="color:#b44">out</span><span style="color:#666">.</span><span style="color:#b44">print</span><span style="color:#666">(</span> params<span style="color:#666">[</span>i<span style="color:#666">]</span> <span style="color:#666">+</span> <span style="color:#b44">&#34; &#34;</span> <span style="color:#666">);</span>
			System<span style="color:#666">.</span><span style="color:#b44">out</span><span style="color:#666">.</span><span style="color:#b44">println</span><span style="color:#666">();</span>
		<span style="color:#666">}</span>
	<span style="color:#666">}</span>
<span style="color:#666">}</span></code></pre></div>
<h3 id="the-cli-class">The CLI class</h3>

<ul>
<li>The CLI class is the worker, running the command loop</li>
<li>As long as there is valid input

<ul>
<li>Read a line</li>
<li>Try to split into command name and parameters</li>
<li>Process the command</li>
</ul></li>
<li>When processing the command

<ul>
<li>Use the command name to get the <em>Command</em> object from the <em>HashMap</em></li>
<li>Invoke/Call/execute the <em>Command</em> object&rsquo;s run method with the argument list (params)</li>
</ul></li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a2f;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">java.io.BufferedReader</span><span style="color:#666">;</span>
<span style="color:#a2f;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">java.io.FileReader</span><span style="color:#666">;</span>
<span style="color:#a2f;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">java.io.IOException</span><span style="color:#666">;</span>
<span style="color:#a2f;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">java.io.InputStreamReader</span><span style="color:#666">;</span>
<span style="color:#a2f;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">java.util.HashMap</span><span style="color:#666">;</span>

<span style="color:#a2f;font-weight:bold">public</span> <span style="color:#a2f;font-weight:bold">class</span> <span style="color:#00f">CLI</span> <span style="color:#666">{</span>

	BufferedReader reader<span style="color:#666">;</span>
	HashMap<span style="color:#666">&lt;</span>String<span style="color:#666">,</span> Command<span style="color:#666">&gt;</span> commands<span style="color:#666">;</span>
	CommandSet cmdSet<span style="color:#666">;</span>

	<span style="color:#080;font-style:italic">/************CONSTRUCTOR**************/</span>

	<span style="color:#080;font-style:italic">// initialize fields and add commands
</span><span style="color:#080;font-style:italic"></span>	<span style="color:#a2f;font-weight:bold">public</span> <span style="color:#00a000">CLI</span><span style="color:#666">(){</span>

		CommandSet base <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">new</span> CommandSet<span style="color:#666">();</span>
		commands <span style="color:#666">=</span> base<span style="color:#666">.</span><span style="color:#b44">commands</span><span style="color:#666">;</span>
	<span style="color:#666">}</span>

	<span style="color:#080;font-style:italic">/*********** ACCESSORS *********************/</span>

	<span style="color:#a2f;font-weight:bold">public</span> String <span style="color:#00a000">getCmdList</span><span style="color:#666">(){</span>
		String clist <span style="color:#666">=</span> <span style="color:#b44">&#34;[ &#34;</span><span style="color:#666">;</span>

		<span style="color:#a2f;font-weight:bold">for</span><span style="color:#666">(</span> String key <span style="color:#666">:</span> commands<span style="color:#666">.</span><span style="color:#b44">keySet</span><span style="color:#666">()){</span>
			clist <span style="color:#666">+=</span> key <span style="color:#666">+</span> <span style="color:#b44">&#34;, &#34;</span><span style="color:#666">;</span>
		<span style="color:#666">}</span>

		clist <span style="color:#666">+=</span> <span style="color:#b44">&#34; ]&#34;</span><span style="color:#666">;</span>
		<span style="color:#a2f;font-weight:bold">return</span> clist<span style="color:#666">;</span>
	<span style="color:#666">}</span>

	<span style="color:#080;font-style:italic">/************* MODIFIERS ************/</span>

	<span style="color:#a2f;font-weight:bold">public</span> <span style="color:#0b0;font-weight:bold">void</span> <span style="color:#00a000">setReader</span><span style="color:#666">(</span> BufferedReader in<span style="color:#666">){</span>
		reader<span style="color:#666">=</span>in<span style="color:#666">;</span>
	<span style="color:#666">}</span>

	<span style="color:#a2f;font-weight:bold">public</span> <span style="color:#0b0;font-weight:bold">void</span> <span style="color:#00a000">setCommandSet</span><span style="color:#666">(</span> CommandSet cs <span style="color:#666">){</span>
		commands <span style="color:#666">=</span> cs<span style="color:#666">.</span><span style="color:#b44">commands</span><span style="color:#666">;</span>
	<span style="color:#666">}</span>

	<span style="color:#080;font-style:italic">/************ PRIVATE METHODS ******************/</span>

	<span style="color:#080;font-style:italic">// get a command and call it&#39;s run method with params
</span><span style="color:#080;font-style:italic"></span>	<span style="color:#a2f;font-weight:bold">private</span> <span style="color:#0b0;font-weight:bold">void</span> <span style="color:#00a000">process</span><span style="color:#666">(</span>String cmd<span style="color:#666">,</span> String<span style="color:#666">[]</span> params<span style="color:#666">){</span>

		<span style="color:#a2f;font-weight:bold">if</span><span style="color:#666">(</span>commands<span style="color:#666">.</span><span style="color:#b44">containsKey</span><span style="color:#666">(</span>cmd<span style="color:#666">))</span>
			commands<span style="color:#666">.</span><span style="color:#b44">get</span><span style="color:#666">(</span>cmd<span style="color:#666">).</span><span style="color:#b44">run</span><span style="color:#666">(</span>params<span style="color:#666">);</span>
		<span style="color:#a2f;font-weight:bold">else</span>
			System<span style="color:#666">.</span><span style="color:#b44">out</span><span style="color:#666">.</span><span style="color:#b44">println</span><span style="color:#666">(</span><span style="color:#b44">&#34;Command not recognized&#34;</span><span style="color:#666">);</span>

	<span style="color:#666">}</span>

    <span style="color:#080;font-style:italic">/************** PUBLIC METHODS ************************/</span>

	<span style="color:#080;font-style:italic">// run the CLI loop
</span><span style="color:#080;font-style:italic"></span>	<span style="color:#a2f;font-weight:bold">public</span> <span style="color:#0b0;font-weight:bold">void</span> <span style="color:#00a000">start</span><span style="color:#666">()</span> <span style="color:#a2f;font-weight:bold">throws</span> IOException<span style="color:#666">{</span>

		String line<span style="color:#666">,</span> cmd<span style="color:#666">;</span>
		String<span style="color:#666">[]</span> params<span style="color:#666">;</span>

		<span style="color:#080;font-style:italic">// read until we run out of input
</span><span style="color:#080;font-style:italic"></span>		<span style="color:#a2f;font-weight:bold">while</span><span style="color:#666">((</span>line <span style="color:#666">=</span> reader<span style="color:#666">.</span><span style="color:#b44">readLine</span><span style="color:#666">())</span> <span style="color:#666">!=</span> <span style="color:#a2f;font-weight:bold">null</span><span style="color:#666">){</span>

			line <span style="color:#666">=</span> line<span style="color:#666">.</span><span style="color:#b44">trim</span><span style="color:#666">();</span>

			<span style="color:#080;font-style:italic">// ignore whitespace lines and lines beginning with #
</span><span style="color:#080;font-style:italic"></span>			<span style="color:#a2f;font-weight:bold">if</span><span style="color:#666">(</span>line<span style="color:#666">.</span><span style="color:#b44">equals</span><span style="color:#666">(</span><span style="color:#b44">&#34;&#34;</span><span style="color:#666">)</span> <span style="color:#666">||</span> line<span style="color:#666">.</span><span style="color:#b44">charAt</span><span style="color:#666">(</span>0<span style="color:#666">)==</span><span style="color:#b44">&#39;#&#39;</span><span style="color:#666">)</span>
				<span style="color:#a2f;font-weight:bold">continue</span><span style="color:#666">;</span>

			<span style="color:#080;font-style:italic">// does this command have params?
</span><span style="color:#080;font-style:italic"></span>			<span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> line<span style="color:#666">.</span><span style="color:#b44">indexOf</span><span style="color:#666">(</span><span style="color:#b44">&#39; &#39;</span><span style="color:#666">);</span>
			<span style="color:#a2f;font-weight:bold">if</span><span style="color:#666">(</span> i <span style="color:#666">&gt;</span> <span style="color:#666">-</span>1<span style="color:#666">){</span>
				cmd <span style="color:#666">=</span> line<span style="color:#666">.</span><span style="color:#b44">substring</span><span style="color:#666">(</span>0<span style="color:#666">,</span>i<span style="color:#666">);</span>
				params <span style="color:#666">=</span> line<span style="color:#666">.</span><span style="color:#b44">substring</span><span style="color:#666">(</span>i<span style="color:#666">+</span>1<span style="color:#666">).</span><span style="color:#b44">split</span><span style="color:#666">(</span><span style="color:#b44">&#34; &#34;</span><span style="color:#666">);</span>
			<span style="color:#666">}</span>
			<span style="color:#a2f;font-weight:bold">else</span><span style="color:#666">{</span>
				cmd <span style="color:#666">=</span> line<span style="color:#666">;</span>
				params <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">new</span> String<span style="color:#666">[]{};</span>
			<span style="color:#666">}</span>

			<span style="color:#080;font-style:italic">// run the command
</span><span style="color:#080;font-style:italic"></span>			process<span style="color:#666">(</span>cmd<span style="color:#666">,</span> params<span style="color:#666">);</span>
		<span style="color:#666">}</span>
	<span style="color:#666">}</span>

	<span style="color:#080;font-style:italic">/************ UNIT TESTING ****************/</span>

	<span style="color:#a2f;font-weight:bold">public</span> <span style="color:#a2f;font-weight:bold">static</span> <span style="color:#0b0;font-weight:bold">void</span> <span style="color:#00a000">main</span><span style="color:#666">(</span>String<span style="color:#666">[]</span> args<span style="color:#666">){</span>

		<span style="color:#080;font-style:italic">// read from consoleIn
</span><span style="color:#080;font-style:italic"></span>		BufferedReader consoleIn<span style="color:#666">;</span>
		consoleIn <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">new</span> BufferedReader<span style="color:#666">(</span><span style="color:#a2f;font-weight:bold">new</span> InputStreamReader<span style="color:#666">(</span>System<span style="color:#666">.</span><span style="color:#b44">in</span><span style="color:#666">));</span>

		<span style="color:#080;font-style:italic">/* OR READ FROM A FILE:
</span><span style="color:#080;font-style:italic">		// reading from a file
</span><span style="color:#080;font-style:italic">		BufferedReader fileIn;
</span><span style="color:#080;font-style:italic">		fileIn = new BufferedReader(new FileReader(&#34;testinput&#34;));
</span><span style="color:#080;font-style:italic">		*/</span>

		CLI cli <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">new</span> CLI<span style="color:#666">();</span>
		cli<span style="color:#666">.</span><span style="color:#b44">setReader</span><span style="color:#666">(</span>consoleIn<span style="color:#666">);</span>

		<span style="color:#a2f;font-weight:bold">try</span> <span style="color:#666">{</span>
			cli<span style="color:#666">.</span><span style="color:#b44">start</span><span style="color:#666">();</span>
		<span style="color:#666">}</span> <span style="color:#a2f;font-weight:bold">catch</span> <span style="color:#666">(</span>IOException e<span style="color:#666">)</span> <span style="color:#666">{</span>
			<span style="color:#080;font-style:italic">// TODO Auto-generated catch block
</span><span style="color:#080;font-style:italic"></span>			e<span style="color:#666">.</span><span style="color:#b44">printStackTrace</span><span style="color:#666">();</span>
		<span style="color:#666">}</span>
	<span style="color:#666">}</span>
<span style="color:#666">}</span></code></pre></div>
</main>

  <footer>
  
  
  <hr/>
  &copy; Michael B. Kulik 2018 | <a href="https://github.com/pinkertoncs">Github</a>
  
  </footer>
  </body>
</html>

